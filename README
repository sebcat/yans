# yans - Yet another network scanner

## Dependencies

### Ubuntu

- build only: build-essential flex bison
- build/run (without -dev): libpcap-dev libseccomp-dev libcap-dev zlib1g-dev

## Architecture

````
                  JSON RPC-style HTTP API
                       /a1/scan/start
                       /a1/scan/stop
                       /a1/scan/list
                            ...
                             ^
      +----------+           |
      |  stored  | <--->     v
      +----------+       +-------+
      |   clid   | <---> | scand |
      +----------+       +-------+
                        /    |    \
                       /     |     \
                 +------+------+---------+----
                 | ethd | tlsd | bannerd |   ...
                 +------+------+---------+----
````

- a1: collection of CGIs communicating with scand, possibly others
- scand: daemon for controlling/coordinating "scans"
- clid: utility daemon for network routes, connections, ...
- stored: utility daemon for opening/closing files in "stores" (dirs)
- ethd, tlsd, bannerd, ...: scan daemons with a single responsibility

a1, scand and the scan daemons run under seccomp-bpf/capsicum (exceptions
can be made)

## clid

- socket(2) (udp) / socket(2)+connect(2) (tcp)
- persistent
- request fds that can be passed to scan daemons
- sock services
- routing tables (separate service)

### sock

- proto: tcp|udp (flagset?)
- sockaddr: optional, struct sockaddr

